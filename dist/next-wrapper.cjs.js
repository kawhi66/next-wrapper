/* https://kawhi.site */'use strict';Object.defineProperty(exports,"__esModule",{value:!0});/**
 * @description manager center for async events
 * @property _state - running status
 * @property _idx - index of current running event
 * @property _queue - async events queue
 */function EventCenter(){this._state=0,this._idx=0,this._queue=[]}EventCenter.prototype.init=function(){this._state=0,this._idx=0,"function"==typeof this._queue[this._idx]&&(this._state=1,this._queue[this._idx](this.next.bind(this)))},EventCenter.prototype.addEvents=function(a){const b=[].slice.call(arguments),c={}.toString.call(a).toLowerCase().split(" ")[1].slice(0,-1);let d=[];1<b.length?b.forEach(a=>{"function"==typeof a?d.push(a):d.push(noop)}):"function"===c?d.push(a):"array"===c&&a.forEach(a=>{"function"==typeof a?d.push(a):d.push(noop)}),this._queue=this._queue.concat(d)},EventCenter.prototype.next=function(){return!(this._queue.length<=this._idx+1)&&void("function"==typeof this._queue[++this._idx]&&this._queue[this._idx](this.next.bind(this)))},EventCenter.prototype.getSnapShot=function(){return{running:!!this._state}};function noop(a){a()}const uuid=require("uuid/v1"),ecmap={default:new EventCenter};function nextWrapper(a,b){const c=[].slice.call(arguments),d=c[c.length-1];let e="default",f=[];"string"==typeof d?2===c.length?(e=b,f.push(a)):(e=d,f=c.slice(0,-1)):f=c,ecmap.hasOwnProperty(e)||(ecmap[e]=new EventCenter),f.forEach(a=>{ecmap[e].addEvents(a)}),ecmap[e].getSnapShot().running||ecmap[e].init()}function nextGenerator(){const a=new EventCenter,b=uuid();return ecmap[b]=a,b}exports.nextGenerator=nextGenerator,exports.nextWrapper=nextWrapper;
